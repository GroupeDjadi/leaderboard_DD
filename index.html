<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Leaderboard DD</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Montserrat:wght@300;400;600&display=swap');
        
        body {
            margin: 0;
            padding: 0;
            overflow: hidden;
            background-color: #f0f8ff; 
            font-family: 'Montserrat', sans-serif;
        }
        
        #image-container {
            position: relative;
            width: 100vw;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }
        
        /* Desktop slides styles */
        .slide {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            opacity: 0;
            transition: all 1.5s ease-in-out;
            transform: scale(0.95);
        }
        
        .slide.active {
            opacity: 1;
            transform: scale(1);
            z-index: 1;
        }
        
        .slide.fade-out {
            opacity: 0;
            transform: scale(1.05);
        }
        
        #current-image {
            max-width: 100%;
            max-height: 100%;
            object-fit: contain;
            image-rendering: -webkit-optimize-contrast;
            image-rendering: crisp-edges;
        }
        
        .logo-slide {
            background-color: #ffffff;
            background: linear-gradient(135deg, #ffffff 0%, #e6f0ff 100%);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }
        
        .logo-container {
            text-align: center;
            padding: 40px;
            animation: float 6s ease-in-out infinite;
        }
        
        .logo-img {
            max-width: 60%;
            max-height: 60vh;
            filter: drop-shadow(0 5px 15px rgba(0, 0, 0, 0.2));
            transition: transform 0.5s ease;
        }
        
        .logo-title {
            margin-top: 30px;
            color: #2c3e50;
            font-size: 2.5rem;
            font-weight: 600;
            text-transform: uppercase;
            letter-spacing: 2px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease-out 0.5s forwards;
        }
        
        .logo-subtitle {
            color: #7f8c8d;
            font-size: 1.2rem;
            font-weight: 300;
            margin-top: 15px;
            opacity: 0;
            transform: translateY(20px);
            animation: fadeInUp 1s ease-out 1s forwards;
        }
        
        /* Mobile-specific styles */
        @media only screen and (max-width: 768px) and (orientation: portrait) {
            #image-container {
                flex-direction: column;
                height: auto;
                min-height: 100vh;
                padding: 20px 0;
                overflow-y: auto;
                justify-content: flex-start;
            }
            
            .mobile-slide {
                width: 90%;
                margin: 15px auto;
                border-radius: 10px;
                box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
                overflow: hidden;
                opacity: 1 !important;
                transform: none !important;
                position: relative;
            }
            
            .mobile-slide img {
                width: 100%;
                height: auto;
                display: block;
            }
            
            .mobile-logo-slide {
                background: linear-gradient(135deg, #ffffff 0%, #e6f0ff 100%);
                padding: 30px 20px;
                text-align: center;
                margin: 20px auto;
            }
            
            .mobile-logo-slide img {
                max-width: 80%;
                margin: 0 auto;
            }
            
            .mobile-logo-title {
                color: #2c3e50;
                font-size: 1.8rem;
                font-weight: 600;
                margin-top: 20px;
            }
            
            /* Hide desktop slides on mobile */
            .slide {
                display: none !important;
            }
        }
        
        .loading {
            color: #2c3e50;
            font-size: 24px;
            text-align: center;
        }
        
        .error {
            color: #e74c3c;
            font-size: 24px;
            text-align: center;
            padding: 20px;
        }
        
        /* Animations */
        @keyframes fadeInUp {
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }
        
        @keyframes float {
            0%, 100% {
                transform: translateY(0);
            }
            50% {
                transform: translateY(-20px);
            }
        }
        
        @keyframes shimmer {
            0% {
                background-position: -1000px 0;
            }
            100% {
                background-position: 1000px 0;
            }
        }
        
        .shimmer {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: linear-gradient(90deg, rgba(255,255,255,0) 0%, rgba(255,255,255,0.8) 50%, rgba(255,255,255,0) 100%);
            background-size: 1000px 100%;
            animation: shimmer 2s infinite;
            z-index: 2;
        }
    </style>
</head>
<body>
    <div id="image-container">
        <div class="loading">Loading...</div>
    </div>

    <script>
        const SHEET_CSV_URL = "https://docs.google.com/spreadsheets/d/e/2PACX-1vT74k0TM-0mmBhad4vnZs9Qye8FDdemuO7468ASeJrxAvdA68nxoivDgDLWkoW6NQBR6h9HAG77ZZAJ/pub?output=csv";
        const IMAGE_DURATION = 10000; 
        const LOGO_DURATION = 5000;   
        
        const COMPANY_LOGOS = [
            {
                url: "https://ik.imagekit.io/agrwi9hyb/frico.png?updatedAt=1747516289991",
                title: "FRICO",
                subtitle: ""
            },
            {
                url: "https://ik.imagekit.io/agrwi9hyb/Snacks.png?updatedAt=1748815175604",
                title: "",
                subtitle: ""
            },
            {
                url: "https://ik.imagekit.io/agrwi9hyb/horeaca.png?updatedAt=1748812925276",
                title: "Horeca",
                subtitle: ""
            },
            {
                url: "https://ik.imagekit.io/agrwi9hyb/lesieur.png?updatedAt=1747516363437",
                title: "Lesieur",
                subtitle: ""
            }
        ];
        
        let currentIndex = 0;
        let imageUrls = [];
        let slideshowActive = true;
        
        function isMobilePortrait() {
            return window.innerWidth <= 768 && window.matchMedia("(orientation: portrait)").matches;
        }
        
        function convertDriveUrl(shareUrl) {
            if (shareUrl.includes('lh3.googleusercontent.com')) {
                return shareUrl.replace(/=s\d+$/, '=s1920');
            }
            
            const match = shareUrl.match(/\/file\/d\/([^\/]+)/) || 
                         shareUrl.match(/id=([^&]+)/) || 
                         shareUrl.match(/\/([^\/]{33})/);
            
            if (match && match[1]) {
                return `https://lh3.googleusercontent.com/d/${match[1]}=s1920`;
            }
            return shareUrl;
        }
        
        async function fetchImageUrls() {
            try {
                const response = await fetch(`${SHEET_CSV_URL}&t=${Date.now()}`);
                if (!response.ok) throw new Error('Failed to fetch sheet');
                const csvData = await response.text();
                const rows = csvData.split('\n').slice(0, 4);
                
                if (rows.length === 0) throw new Error('No data in sheet');
                
                return rows.map(row => {
                    const url = row.split(',')[0].trim();
                    if (!url) throw new Error('Empty URL in sheet');
                    return url;
                });
            } catch (error) {
                showError(`Sheet error: ${error.message}`);
                return null;
            }
        }
        
        function showError(message) {
            const container = document.getElementById('image-container');
            container.innerHTML = `<div class="error">${message}</div>`;
        }
        
        function createImageSlide(url) {
            if (isMobilePortrait()) {
                const slide = document.createElement('div');
                slide.className = 'mobile-slide';
                
                const img = document.createElement('img');
                img.src = convertDriveUrl(url);
                img.style.width = '100%';
                
                img.onload = function() {
                    console.log(`Image loaded: ${img.naturalWidth}x${img.naturalHeight}`);
                };
                
                img.onerror = function() {
                    slide.innerHTML = `<div class="error">Image failed to load</div>`;
                };
                
                slide.appendChild(img);
                return slide;
            } else {
                const slide = document.createElement('div');
                slide.className = 'slide';
                
                const img = document.createElement('img');
                img.id = 'current-image';
                img.src = convertDriveUrl(url);
                
                img.onload = function() {
                    console.log(`Image loaded: ${img.naturalWidth}x${img.naturalHeight}`);
                };
                
                img.onerror = function() {
                    slide.innerHTML = `<div class="error">Image failed to load</div>`;
                };
                
                slide.appendChild(img);
                return slide;
            }
        }
        
        function createLogoSlide(logoData) {
            if (isMobilePortrait()) {
                const slide = document.createElement('div');
                slide.className = 'mobile-slide mobile-logo-slide';
                
                const img = document.createElement('img');
                img.src = logoData.url;
                img.alt = logoData.title;
                img.style.maxWidth = '80%';
                img.style.margin = '0 auto';
                img.style.display = 'block';
                
                slide.appendChild(img);
                
                if (logoData.title) {
                    const title = document.createElement('h2');
                    title.className = 'mobile-logo-title';
                    title.textContent = logoData.title;
                    slide.appendChild(title);
                }
                
                return slide;
            } else {
                const slide = document.createElement('div');
                slide.className = 'slide logo-slide';
                
                const container = document.createElement('div');
                container.className = 'logo-container';
                
                const img = document.createElement('img');
                img.className = 'logo-img';
                img.src = logoData.url;
                img.alt = logoData.title;
                
                const title = document.createElement('h1');
                title.className = 'logo-title';
                title.textContent = logoData.title;
                
                const subtitle = document.createElement('p');
                subtitle.className = 'logo-subtitle';
                subtitle.textContent = logoData.subtitle;
                
                container.appendChild(img);
                container.appendChild(title);
                container.appendChild(subtitle);
                slide.appendChild(container);
                
                const shimmer = document.createElement('div');
                shimmer.className = 'shimmer';
                slide.appendChild(shimmer);
                
                return slide;
            }
        }
        
        function showSlide(slide) {
            const container = document.getElementById('image-container');
            
            if (isMobilePortrait()) {
                // For mobile, just append the slide (we'll show all slides stacked)
                container.appendChild(slide);
            } else {
                // For desktop, do the transition effect
                const currentActive = container.querySelector('.slide.active');
                if (currentActive) {
                    currentActive.classList.remove('active');
                    currentActive.classList.add('fade-out');
                    
                    setTimeout(() => {
                        currentActive.remove();
                    }, 1500);
                }
                
                container.innerHTML = '';
                container.appendChild(slide);
                
                setTimeout(() => {
                    slide.classList.add('active');
                }, 50);
            }
        }
        
        async function startSlideshow() {
            const urls = await fetchImageUrls();
            if (!urls || urls.length === 0) return;
            
            imageUrls = urls;
            
            if (isMobilePortrait()) {
                // For mobile portrait, show all slides stacked vertically
                const container = document.getElementById('image-container');
                container.innerHTML = '';
                
                // First show all logos
                COMPANY_LOGOS.forEach(logo => {
                    const slide = createLogoSlide(logo);
                    showSlide(slide);
                });
                
                // Then show all images from the sheet
                imageUrls.forEach(url => {
                    const slide = createImageSlide(url);
                    showSlide(slide);
                });
            } else {
                // For desktop, do the slideshow as before
                function nextSlide() {
                    if (!slideshowActive) return;
                    
                    if (currentIndex % 2 === 0) {
                        const imageIdx = (currentIndex / 2) % imageUrls.length;
                        const slide = createImageSlide(imageUrls[imageIdx]);
                        showSlide(slide);
                        setTimeout(nextSlide, IMAGE_DURATION);
                    } else {
                        const logoIdx = Math.floor(currentIndex / 2) % COMPANY_LOGOS.length;
                        const slide = createLogoSlide(COMPANY_LOGOS[logoIdx]);
                        showSlide(slide);
                        setTimeout(nextSlide, LOGO_DURATION);
                    }
                    
                    currentIndex++;
                }
                
                nextSlide();
            }
        }
        
        document.addEventListener('DOMContentLoaded', () => {
            if (!isMobilePortrait()) {
                enterFullscreen();
            }
            startSlideshow();
        });
        
        function enterFullscreen() {
            if (!document.fullscreenElement && !isMobilePortrait()) {
                document.documentElement.requestFullscreen().catch(err => {
                    console.error('Fullscreen error:', err);
                });
            }
        }
        
        document.addEventListener('click', enterFullscreen);
        window.addEventListener('load', enterFullscreen);
        
        window.addEventListener('resize', () => {
            
            if (isMobilePortrait()) {
                
            }
        });
    </script>
</body>
</html>
